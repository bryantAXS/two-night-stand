var selField=false,selMode="normal";function setFieldName(a){if(a!=selField){selField=a;clear_state();tagarray=new Array();usedarray=new Array();running=0}}function taginsert(item,tagOpen,tagClose){var which=eval("item.name");if(!selField){$.ee_notice(no_cursor);return false}var theSelection=false,result=false,theField=document.getElementById("entryform")[selField];if(selMode=="guided"){data=prompt(enter_text,"");if((data!=null)&&(data!="")){result=tagOpen+data+tagClose}}if(document.selection){theSelection=document.selection.createRange().text;theField.focus();if(theSelection){document.selection.createRange().text=(result==false)?tagOpen+theSelection+tagClose:result}else{document.selection.createRange().text=(result==false)?tagOpen+tagClose:result}theSelection="";theField.blur();theField.focus();return}else{if(!isNaN(theField.selectionEnd)){var newStart,scrollPos=theField.scrollTop,selLength=theField.textLength,selStart=theField.selectionStart,selEnd=theField.selectionEnd;if(selEnd<=2&&typeof(selLength)!="undefined"){selEnd=selLength}var s1=(theField.value).substring(0,selStart),s2=(theField.value).substring(selStart,selEnd).s3=(theField.value).substring(selEnd,selLength);if(result==false){newStart=selStart+tagOpen.length+s2.length+tagClose.length;theField.value=(result==false)?s1+tagOpen+s2+tagClose+s3:result}else{newStart=selStart+result.length;theField.value=s1+result+s3}theField.focus();theField.selectionStart=newStart;theField.selectionEnd=newStart;theField.scrollTop=scrollPos;return}else{if(selMode=="guided"){curField=document.submit_post[selfField];curField.value+=result;curField.blur();curField.focus();return}}}if(item=="other"){eval("document.getElementById('entryform')."+selField+".value += tagOpen")}else{if(eval(which)==0){var result=tagOpen;eval("document.getElementById('entryform')."+selField+".value += result");eval(which+" = 1");arraypush(tagarray,tagClose);arraypush(usedarray,which);running++;styleswap(which)}else{n=0;for(i=0;i<tagarray.length;i++){if(tagarray[i]==tagClose){n=i;running--;while(tagarray[n]){closeTag=arraypop(tagarray);eval("document.getElementById('entryform')."+selField+".value += closeTag")}while(usedarray[n]){clearState=arraypop(usedarray);eval(clearState+" = 0");document.getElementById(clearState).className="htmlButtonA"}}}if(running<=0&&document.getElementById("close_all").className=="htmlButtonB"){document.getElementById("close_all").className="htmlButtonA"}}}curField=eval("document.getElementById('entryform')."+selField);curField.blur();curField.focus()}$(document).ready(function(){$(".js_show").show();$(".js_hide").hide();if(EE.publish.markitup!==undefined&&EE.publish.markitup.fields!==undefined){$.each(EE.publish.markitup.fields,function(c,d){$("#"+c).markItUp(mySettings)})}if(EE.publish.smileys===true){$("a.glossary_link").click(function(){$(this).parent().siblings(".glossary_content").slideToggle("fast");$(this).parent().siblings(".smileyContent .spellcheck_content").hide();return false});$("a.smiley_link").toggle(function(){which=$(this).attr("id").substr(12);$("#smiley_table_"+which).slideDown("fast",function(){$(this).css("display","")})},function(){$("#smiley_table_"+which).slideUp("fast")});$(this).parent().siblings(".glossary_content, .spellcheck_content").hide();$(".glossary_content a").click(function(){$.markItUp({replaceWith:$(this).attr("title")});return false})}$(".btn_plus a").click(function(){return confirm(EE.lang.confirm_exit,"")});$(".markItUpHeader ul").prepend('<li class="close_formatting_buttons"><a href="#"><img width="10" height="10" src="'+EE.THEME_URL+'images/publish_minus.gif" alt="Close Formatting Buttons"/></a></li>');$(".close_formatting_buttons a").toggle(function(){$(this).parent().parent().children(":not(.close_formatting_buttons)").hide();$(this).parent().parent().css("height","13px");$(this).children("img").attr("src",EE.THEME_URL+"images/publish_plus.png")},function(){$(this).parent().parent().children().show();$(this).parent().parent().css("height","22px");$(this).children("img").attr("src",EE.THEME_URL+"images/publish_minus.gif")});$.ee_filebrowser();var b="";if(EE.publish.show_write_mode===true){$("#write_mode_textarea").markItUp(myWritemodeSettings)}$(".write_mode_trigger").click(function(){if($(this).attr("id").match(/^id_\d+$/)){b="field_"+$(this).attr("id")}else{b=$(this).attr("id").replace(/id_/,"")}$("#write_mode_textarea").val($("#"+b).val());$("#write_mode_textarea").focus();return false});$(".btn_img a, .file_manipulate").click(function(){window.file_manager_context=($(this).parent().attr("class").indexOf("markItUpButton")==-1)?$(this).closest("div").find("input").attr("id"):"textarea_a8LogxV4eFdcbC"});$.ee_filebrowser.add_trigger(".btn_img a, .file_manipulate",function(c){if(window.file_manager_context=="textarea_a8LogxV4eFdcbC"){if(!c.is_image){$.markItUp({name:"Link",key:"L",openWith:'<a href="{filedir_'+c.directory+"}"+c.name+'">',closeWith:"</a>",placeHolder:c.name})}else{$.markItUp({replaceWith:'<img src="{filedir_'+c.directory+"}"+c.name+'" alt="[![Alternative text]!]" '+c.dimensions+"/>"})}}else{$("#"+window.file_manager_context).val("{filedir_"+c.directory+"}"+c.name)}});function a(d,e){var c=$("input[name="+e+"]").closest(".publish_field");if(d.is_image==false){c.find(".file_set").show().find(".filename").html('<img src="'+EE.PATH_CP_GBL_IMG+'default.png" alt="'+EE.PATH_CP_GBL_IMG+'default.png" /><br />'+d.name)}else{c.find(".file_set").show().find(".filename").html('<img src="'+d.thumb+'" alt="'+d.name+'" /><br />'+d.name)}$("input[name="+e+"_hidden]").val(d.name);$("select[name="+e+"_directory]").val(d.directory);$.ee_filebrowser.reset()}$("input[type=file]","#publishForm").each(function(){var c=$(this).closest(".publish_field"),d=c.find(".choose_file");$.ee_filebrowser.add_trigger(d,$(this).attr("name"),a);c.find(".remove_file").click(function(){c.find("input[type=hidden]").val("");c.find(".file_set").hide();return false})})});